<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    @page { size: A4; margin: 8mm; }
    body { font-family: Arial, sans-serif; margin: 0;padding: 6px; }

    .sheet {
      display: flex;
      flex-direction: column;
      gap: 15px;
      height: 100%;
      page-break-after: always;
    }
    .sheet:last-of-type { page-break-after: auto; }

    .slip {
      border: 2px solid #000;
      border-radius: 6px;
      padding: 6px;
      flex: 1;
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }

    /* Header */
    .header {
      display: flex;
      align-items: center;
      border-bottom: 1px solid #000;
      padding-bottom: 4px;
      margin-bottom: 4px;
    }
    .header img.logo {
      height: 80px;
      width: 80px;
      object-fit: contain;
      margin-right: 6px;
    }
    .header .school-details {
      flex: 1;
      text-align: center;
    }
    .header h3 { margin: 0; font-size: 30px; }
    .header h4 { margin: 0; font-size: 22px; }

    /* Student Row */
    .student-row {
      display: flex;
      margin-bottom: 6px;
    }
    .student-row .photo-wrap {
      flex: 0 0 60px;
      display: flex;
      justify-content: center;
    }
    .student-row img.photo {
      width: 55px;
      height: 70px;
      border: 1px solid #000;
      object-fit: cover;
    }
    .student-row .info {
      flex: 1;
      padding-left: 8px;
    }
    .info p { margin: 2px 0; font-size: 15px; }
    .label { font-weight: bold; }

    /* Datesheet */
    .datesheet {
      border-top: 1px dashed #000;
      font-size: 14px;
    }
    .datesheet p{
      margin: 2px ;
    }
    .datesheet table {
      width: 100%;
      border: 1px solid #000;
      border-collapse: collapse;
      text-align: center;
    }
    .datesheet td {
      border: 1px solid #000;
      padding: 2px;
    }
    .datesheet tr:first-child td {
      font-weight: bold;
      background: #f2f2f2;
    }

    /* Notices / Instructions */
    .notice {
      border-top: 1px solid #000;
      padding-top: 4px;
      font-size: 10px;
    }
    .notice h5 {
      margin: 0 0 2px;
      font-size: 10px;
      font-weight: bold;
      text-decoration: underline;
    }
    .notice ul {
      margin: 0;
      padding-left: 14px;
    }
    .notice li {
      margin-bottom: 2px;
    }
  </style>
</head>
<body>
  <% for (let i = 0; i < students.length; i += 3) { %>
    <div class="sheet">
      <% students.slice(i, i + 3).forEach(st => { %>
        <div class="slip">
          <!-- Header -->
          <div class="header">
            <img src="<%= logoBase64 %>" class="logo" alt="School Logo">
            <div class="school-details">
              <h3>HPS SCHOOL, HANSI (HISAR)</h3>
              <h4>SA-1 Roll No. Slip (2025-26)</h4>
            </div>
          </div>

          <!-- Student Info -->
          <div class="student-row">
            <div class="photo-wrap">
              <img src="<%= st.PhotoBase64 %>" class="photo" alt="Photo">
            </div>
            <div class="info">
              <p><span class="label">Name:</span> <%= st.Name %></p>
              <p><span class="label">Roll No:</span> <%= st.RollNo %></p>
              <p><span class="label">Class:</span> <%= st.Class %></p>
              <p><span class="label">Father's Name:</span> <%= st.FatherName %></p>
            </div>
          </div>

          <!-- Datesheet -->
          <div class="datesheet">
            <p><span class="label">Datesheet SA-1</span> </p>
            <table>
              <tr>
                <% datesheet.forEach(d => { %>
                  <td><%= d.date %></td>
                <% }) %>
              </tr>
              <tr>
                <% datesheet.forEach(d => { %>
                  <td><%= d.subject %></td>
                <% }) %>
              </tr>
            </table>
          </div>
           <!-- Notices -->
          <div class="notice">
            <h5>Instructions:</h5>
            <ul>
              <li>Student must carry this slip to the exam hall.</li>
              <li>Mobile phones & electronic devices are strictly prohibited.</li>
              <li>Reach the examination hall 15 minutes before start time.</li>
              <li>Follow all instructions given by the invigilator.</li>
            </ul>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</body>
</html>
